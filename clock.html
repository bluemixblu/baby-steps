<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¿«æ¨‚å­¸æ™‚é˜</title>
    <!-- å¼•å…¥ Tailwind CSS (ç”¨æ–¼ç¾è§€çš„æ¨£å¼) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥ React å’Œ ReactDOM (æ ¸å¿ƒé‹ä½œé‚è¼¯) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- å¼•å…¥ Babel (è®“ç€è¦½å™¨çœ‹æ‡‚ç¾ä»£ç¨‹å¼ç¢¼) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f9ff; /* sky-50 */
            touch-action: manipulation; /* æ”¹å–„è§¸æ§é«”é©— */
        }
        /* ç°¡å–®çš„æ·¡å…¥å‹•ç•« */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes bounceIn {
            0% { transform: scale(0.8); opacity: 0; }
            60% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); }
        }
        .animate-in {
            animation: fadeIn 0.3s ease-out forwards;
        }
        .animate-bounce-in {
            animation: bounceIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }
        /* éš±è—é¸å–æ–‡å­—ï¼Œé¿å…æ‹–æ›³æ™‚é¸åˆ°æ–‡å­— */
        .no-select {
            user-select: none;
            -webkit-user-select: none;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- åœ–ç¤ºçµ„ä»¶ ---
        const IconClock = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
        );
        const IconEye = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>
        );
        const IconEyeOff = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/></svg>
        );
        const IconRotateCcw = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></svg>
        );
        const IconPlay = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="5 3 19 12 5 21 5 3"/></svg>
        );
        const IconPause = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>
        );
        const IconDice = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><path d="M16 8h.01"/><path d="M8 8h.01"/><path d="M8 16h.01"/><path d="M16 16h.01"/><path d="M12 12h.01"/></svg>
        );
        const IconCheck = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="20 6 9 17 4 12"/></svg>
        );
        const IconStar = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
        );

        const LearningClock = () => {
            // mode: 'realtime'(ç¾åœ¨æ™‚é–“), 'practice'(ç·´ç¿’æ¨¡å¼), 'challenge'(æŒ‘æˆ°æ¨¡å¼/Quiz)
            const [mode, setMode] = useState('practice'); 
            const [time, setTime] = useState(new Date());
            const [showDigital, setShowDigital] = useState(true);

            // ç”¨æ–¼ç·´ç¿’æ¨¡å¼/æŒ‘æˆ°æ¨¡å¼çš„æ‰‹å‹•æ™‚é–“ (ä»¥åˆ†é˜ç‚ºå–®ä½)
            const [manualMinutes, setManualMinutes] = useState(720); // é è¨­ 12:00

            // æŒ‘æˆ°æ¨¡å¼å°ˆç”¨ state
            const [targetMinutes, setTargetMinutes] = useState(null);
            const [feedback, setFeedback] = useState(null); // 'correct', 'wrong', null

            const clockRef = useRef(null);
            const [isDragging, setIsDragging] = useState(false);
            const lastAngleRef = useRef(0);
            
            // æ–°å¢ï¼šç´€éŒ„ç›®å‰æ­£åœ¨æ‹–æ›³å“ªä¸€æ ¹é‡ ('minute' æˆ– 'hour')
            const dragTargetRef = useRef('minute'); 

            // æ›´æ–°çœŸå¯¦æ™‚é–“
            useEffect(() => {
                let interval;
                if (mode === 'realtime') {
                    interval = setInterval(() => {
                        setTime(new Date());
                    }, 1000);
                }
                return () => clearInterval(interval);
            }, [mode]);

            // å–å¾—ç•¶å‰é¡¯ç¤ºçš„å°æ™‚èˆ‡åˆ†é˜
            const getDisplayTime = () => {
                if (mode === 'realtime') {
                    return {
                        hours: time.getHours(),
                        minutes: time.getMinutes(),
                    };
                } else {
                    // ä¿®æ­£ï¼šä½¿ç”¨ normalize è™•ç†é¡¯ç¤ºæ™‚é–“ï¼Œå› ç‚º manualMinutes ç¾åœ¨å¯ä»¥ç„¡é™ç´¯åŠ 
                    const normalized = ((manualMinutes % 1440) + 1440) % 1440;
                    const h = Math.floor(normalized / 60) % 12;
                    return {
                        hours: h === 0 ? 12 : h,
                        minutes: normalized % 60,
                        totalMinutes: normalized // for logic
                    };
                }
            };

            const { hours, minutes } = getDisplayTime();

            // è¨ˆç®—æŒ‡é‡è§’åº¦
            // ä¿®æ­£ï¼šç·´ç¿’æ¨¡å¼æ”¹ç”¨ç„¡é™ç´¯åŠ çš„åˆ†é˜æ•¸ä¾†ç®—è§’åº¦ï¼Œè§£æ±º 59->0 åˆ†å€’è½‰çš„å•é¡Œ
            let minuteDeg, hourDeg;
            if (mode === 'realtime') {
                minuteDeg = time.getMinutes() * 6;
                hourDeg = (time.getHours() % 12) * 30 + time.getMinutes() * 0.5;
            } else {
                minuteDeg = manualMinutes * 6;
                hourDeg = manualMinutes * 0.5;
            }

            // --- é‚è¼¯åŠŸèƒ½ ---

            const adjustTime = (changeInMinutes) => {
                setFeedback(null); // æ¸…é™¤æŒ‘æˆ°æ¨¡å¼çš„çµæœ
                if(mode === 'realtime') setMode('practice');
                
                // æ–°å¢ï¼šç•¶ä½¿ç”¨æŒ‰éˆ•èª¿æ•´æ™‚é–“æ™‚ï¼Œè‡ªå‹•é¡¯ç¤ºé›»å­é˜æ•¸å­—ï¼Œæ–¹ä¾¿å³æ™‚è§€å¯Ÿ
                if(mode === 'practice') setShowDigital(true);

                // ä¿®æ­£ï¼šä¸å†å¼·åˆ¶ % 1440ï¼Œå…è¨±æ™‚é–“ç„¡é™ç´¯åŠ /éæ¸›ï¼Œä¿æŒæ—‹è½‰æ–¹å‘æ­£ç¢º
                setManualMinutes((prev) => prev + changeInMinutes);
            };

            // éš¨æ©Ÿå‡ºé¡Œ (ç·´ç¿’æ¨¡å¼ 1ï¼šéš±è—æ•¸å­—çŒœæ™‚é–“)
            const setRandomTimePractice = () => {
                setMode('practice');
                const randomMins = Math.floor(Math.random() * (12 * 12)) * 5; // 5åˆ†é˜ä¸€è·³
                setManualMinutes(randomMins);
                setShowDigital(false);
                setFeedback(null);
            };

            // é–‹å§‹æŒ‘æˆ° (ç·´ç¿’æ¨¡å¼ 2ï¼šçœ‹æ•¸å­—æ’¥æŒ‡é‡)
            const startChallenge = () => {
                setMode('challenge');
                const randomMins = Math.floor(Math.random() * (12 * 12)) * 5; // 5åˆ†é˜ä¸€è·³
                setTargetMinutes(randomMins);
                // é‡ç½®æ™‚é˜åˆ°ä¸€å€‹ä¸ç›¸é—œçš„æ™‚é–“ (ä¾‹å¦‚ 12:00)ï¼Œè®“å°æœ‹å‹é‡æ–°æ’¥
                setManualMinutes(720); 
                setShowDigital(false); // æŒ‘æˆ°æ¨¡å¼ä¸é¡¯ç¤ºç•¶å‰æ•¸å­—(å› ç‚ºé‚£æ˜¯ç­”æ¡ˆ)
                setFeedback(null);
            };

            // æª¢æŸ¥ç­”æ¡ˆ
            const checkAnswer = () => {
                // æ¯”å°å°æ™‚å’Œåˆ†é˜ (éœ€å…ˆå°‡ç„¡é™ç´¯åŠ çš„æ™‚é–“æ¨™æº–åŒ–åˆ° 0-720 å€é–“)
                const currentTotal = ((manualMinutes % 720) + 720) % 720;
                const targetTotal = ((targetMinutes % 720) + 720) % 720;

                // å…è¨±ä¸€é»é»èª¤å·®å—ï¼Ÿä¸ï¼Œå› ç‚ºæ•¸å­—æ˜¯5åˆ†é˜ä¸€è·³ï¼Œæ‡‰è©²è¦æº–ç¢º
                if (currentTotal === targetTotal) {
                    setFeedback('correct');
                } else {
                    setFeedback('wrong');
                }
            };

            // --- æ‹–æ›³é‚è¼¯ ---
            
            // è¼”åŠ©å‡½å¼ï¼šè¨ˆç®—å…©å€‹è§’åº¦åœ¨åœ“å‘¨ä¸Šçš„æœ€çŸ­è·é›¢
            const getShortestAngleDiff = (angle1, angle2) => {
                const diff = Math.abs(angle1 - angle2);
                return Math.min(diff, 360 - diff);
            };

            const calculateAngle = (e) => {
                if (!clockRef.current) return 0;
                const rect = clockRef.current.getBoundingClientRect();
                const centerX = rect.left + rect.width / 2;
                const centerY = rect.top + rect.height / 2;
                
                // è™•ç†è§¸æ§æˆ–æ»‘é¼ äº‹ä»¶
                const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                const clientY = e.touches ? e.touches[0].clientY : e.clientY;

                const x = clientX - centerX;
                const y = clientY - centerY;
                
                // Math.atan2 å›å‚³ -PI ~ PIï¼Œ0 æ˜¯ 3é»é˜æ–¹å‘
                let rad = Math.atan2(y, x);
                let deg = rad * (180 / Math.PI);
                
                // è½‰æ›æˆæ™‚é˜è§’åº¦ï¼š0åº¦æ˜¯12é»é˜æ–¹å‘
                return (deg + 90 + 360) % 360;
            };

            const handlePointerDown = (e) => {
                if (mode === 'realtime') return; // çœŸå¯¦æ™‚é–“æ¨¡å¼ä¸èƒ½æ’¥
                e.preventDefault(); // é˜²æ­¢æ»¾å‹•
                
                const clickAngle = calculateAngle(e);
                lastAngleRef.current = clickAngle;
                setFeedback(null); // é–‹å§‹æ’¥å‹•å°±æ¸…é™¤çµæœ

                // æ–°å¢ï¼šå¦‚æœæ˜¯ç·´ç¿’æ¨¡å¼ï¼Œç•¶ä½¿ç”¨è€…é–‹å§‹æ’¥å‹•æŒ‡é‡æ™‚ï¼Œè‡ªå‹•é¡¯ç¤ºæ•¸å­—
                // é€™æ¨£å°æœ‹å‹æ’¥å‹•æŒ‡é‡æ™‚ï¼Œå¯ä»¥é¦¬ä¸Šçœ‹åˆ°ä¸‹æ–¹æ•¸å­—è·Ÿè‘—è®Šï¼Œä¸ç”¨å†æŒ‰é–‹çœ¼ç›
                if (mode === 'practice') {
                    setShowDigital(true);
                }

                // åˆ¤æ–·ä½¿ç”¨è€…æƒ³è¦æ‹–æ›³å“ªä¸€æ ¹é‡
                // å–å¾—ç›®å‰æ™‚é‡å’Œåˆ†é‡çš„è§’åº¦ (éœ€å°‡ç„¡é™ç´¯åŠ çš„æ™‚é–“è½‰å› 0-360 åº¦)
                const currentMinAngle = ((manualMinutes * 6) % 360 + 360) % 360;
                const currentHourAngle = ((manualMinutes * 0.5) % 360 + 360) % 360;

                // è¨ˆç®—é»æ“Šä½ç½®è·é›¢æ™‚é‡å’Œåˆ†é‡å„å·®å¹¾åº¦
                const distToMin = getShortestAngleDiff(clickAngle, currentMinAngle);
                const distToHour = getShortestAngleDiff(clickAngle, currentHourAngle);

                // å¦‚æœè·é›¢æ™‚é‡æ¯”åˆ†é‡è¿‘ï¼Œå°±åˆ¤å®šç‚ºæ‹–æ›³æ™‚é‡ï¼Œå¦å‰‡é è¨­ç‚ºåˆ†é‡
                if (distToHour < distToMin) {
                    dragTargetRef.current = 'hour';
                } else {
                    dragTargetRef.current = 'minute';
                }
                
                // è¨­å®šç‹€æ…‹é–‹å§‹æ‹–æ›³ (æ”¾åœ¨åˆ¤æ–· target ä¹‹å¾Œï¼Œç¢ºä¿æ¸²æŸ“æ™‚èƒ½æŠ“åˆ°æ­£ç¢ºçš„ target)
                setIsDragging(true);
            };

            const handlePointerMove = (e) => {
                if (!isDragging || mode === 'realtime') return;
                e.preventDefault();

                const currentAngle = calculateAngle(e);
                let delta = currentAngle - lastAngleRef.current;

                // è™•ç†è·¨è¶Š 0/360 åº¦çš„é‚Šç•Œæƒ…æ³
                if (delta > 180) delta -= 360;
                if (delta < -180) delta += 360;

                let minutesChange = 0;

                if (dragTargetRef.current === 'minute') {
                    // æ‹–æ›³ã€åˆ†é‡ã€‘ï¼šåˆ†é‡è½‰ 6 åº¦ = 1 åˆ†é˜
                    // å››æ¨äº”å…¥é¿å…æŠ–å‹•
                    minutesChange = Math.round(delta / 6);
                } else {
                    // æ‹–æ›³ã€æ™‚é‡ã€‘ï¼šæ™‚é‡è½‰ 1 åº¦ = 2 åˆ†é˜ (å› ç‚ºæ™‚é‡è½‰ä¸€åœˆ360åº¦=720åˆ†é˜ï¼Œ360/720 = 0.5åº¦/åˆ†)
                    // æ™‚é‡ç§»å‹•è¼ƒæ…¢ï¼Œä½†æ™‚é–“æ”¹è®Šé‡å¤§
                    minutesChange = Math.round(delta * 2); 
                }

                if (minutesChange !== 0) {
                   // ä¿®æ­£ï¼šç›´æ¥ç´¯åŠ ï¼Œä¸é€²è¡Œ % 1440 é™åˆ¶ï¼Œè®“æŒ‡é‡å¯ä»¥ç„¡é™é †/é€†æ™‚é‡æ—‹è½‰
                   setManualMinutes(prev => prev + minutesChange);
                   
                   // åªæœ‰ç•¶æ™‚é–“çœŸçš„æ”¹è®Šæ™‚ï¼Œæ‰æ›´æ–° lastAngleï¼Œé€™æ¨£å¯ä»¥ç´¯ç©å¾®å°çš„ç§»å‹•ç›´åˆ°è¶³ä»¥æ”¹è®Šä¸€åˆ†é˜
                   lastAngleRef.current = currentAngle; 
                }
            };

            const handlePointerUp = () => {
                setIsDragging(false);
                // æ‹–æ›³çµæŸå¾Œï¼Œå°‡æ™‚é–“å°é½Šåˆ°æœ€è¿‘çš„åˆ†é˜
                setManualMinutes(prev => Math.round(prev));
            };

            // åˆ¤æ–·æ˜¯å¦æ­£åœ¨æ‹–æ›³ç‰¹å®šæŒ‡é‡ (ç”¨æ–¼é¡¯ç¤ºé«˜äº®æ•ˆæœ)
            const isDraggingHour = isDragging && dragTargetRef.current === 'hour';
            const isDraggingMinute = isDragging && dragTargetRef.current === 'minute';

            // --- Render Helpers ---
            const renderClockNumbers = () => {
                const numbers = [];
                for (let i = 1; i <= 12; i++) {
                    const angle = i * 30; 
                    const radius = 110;
                    const x = Math.sin((angle * Math.PI) / 180) * radius;
                    const y = -Math.cos((angle * Math.PI) / 180) * radius;
                    
                    numbers.push(
                        <div key={i} className="absolute font-bold text-2xl text-slate-700 pointer-events-none"
                             style={{ transform: `translate(${x}px, ${y}px)` }}>
                            {i}
                        </div>
                    );
                }
                return numbers;
            };

            const renderTicks = () => {
                const ticks = [];
                for (let i = 0; i < 60; i++) {
                    const angle = i * 6;
                    const isHourTick = i % 5 === 0;
                    const height = isHourTick ? 12 : 6;
                    const width = isHourTick ? 4 : 2;
                    const color = isHourTick ? 'bg-slate-400' : 'bg-slate-200';
                    ticks.push(
                        <div key={i} className={`absolute origin-bottom ${color} rounded-full pointer-events-none`}
                             style={{ height: `${height}px`, width: `${width}px`, transform: `rotate(${angle}deg) translate(0, -135px)` }} />
                    );
                }
                return ticks;
            };

            // å–å¾—æŒ‘æˆ°æ¨¡å¼çš„ç›®æ¨™æ™‚é–“å­—ä¸²
            const getTargetTimeString = () => {
                if (targetMinutes === null) return "";
                const h = Math.floor(targetMinutes / 60) % 12;
                const displayH = h === 0 ? 12 : h;
                const m = targetMinutes % 60;
                return `${displayH}:${m.toString().padStart(2, '0')}`;
            };

            return (
                <div className="min-h-screen flex flex-col items-center justify-center p-4 font-sans no-select">
                    
                    {/* æ¨™é¡Œå€ */}
                    <header className="mb-4 text-center">
                        <h1 className="text-3xl md:text-4xl font-bold text-sky-600 flex items-center gap-3 justify-center mb-1">
                            <IconClock size={36} />
                            å¿«æ¨‚å­¸æ™‚é˜
                        </h1>
                        <p className="text-slate-500 text-lg">
                            {mode === 'challenge' ? 'æŒ‘æˆ°æ¨¡å¼ï¼šæ’¥å‡ºæ­£ç¢ºçš„æ™‚é–“' : 'èªè­˜é•·é‡èˆ‡çŸ­é‡'}
                        </p>
                    </header>

                    {/* æ¨¡å¼åˆ‡æ› Tabs */}
                    <div className="flex bg-slate-200 p-1 rounded-xl mb-6 w-full max-w-lg">
                        <button onClick={() => setMode('practice')}
                            className={`flex-1 py-2 rounded-lg font-bold text-sm md:text-base transition-all ${mode === 'practice' ? 'bg-white text-sky-600 shadow-sm' : 'text-slate-500 hover:text-slate-700'}`}>
                            ç·´ç¿’æ¨¡å¼ 1<br/><span className="text-xs font-normal">çœ‹é˜çŒœæ™‚é–“</span>
                        </button>
                        <button onClick={startChallenge}
                            className={`flex-1 py-2 rounded-lg font-bold text-sm md:text-base transition-all ${mode === 'challenge' ? 'bg-white text-purple-600 shadow-sm' : 'text-slate-500 hover:text-slate-700'}`}>
                            ç·´ç¿’æ¨¡å¼ 2<br/><span className="text-xs font-normal">çœ‹æ•¸å­—æ’¥é˜</span>
                        </button>
                        <button onClick={() => setMode('realtime')}
                            className={`flex-1 py-2 rounded-lg font-bold text-sm md:text-base transition-all ${mode === 'realtime' ? 'bg-white text-green-600 shadow-sm' : 'text-slate-500 hover:text-slate-700'}`}>
                            ç¾åœ¨æ™‚é–“
                        </button>
                    </div>

                    {/* ä¸»æ§åˆ¶é¢æ¿ */}
                    <div className="bg-white rounded-3xl shadow-xl p-6 md:p-8 w-full max-w-lg flex flex-col items-center border-4 border-sky-100 relative overflow-hidden">
                        
                        {/* æŒ‘æˆ°æ¨¡å¼çš„å•é¡Œæç¤º */}
                        {mode === 'challenge' && (
                            <div className="bg-purple-50 w-full rounded-xl p-3 mb-4 text-center border-2 border-purple-100">
                                <span className="text-slate-500 text-sm block mb-1">è«‹æ’¥å‡ºé€™å€‹æ™‚é–“</span>
                                <div className="text-4xl font-bold text-purple-600 font-mono tracking-wider animate-bounce-in">
                                    {getTargetTimeString()}
                                </div>
                            </div>
                        )}

                        {/* æ™‚é˜æœ¬é«” */}
                        <div 
                            className="relative w-72 h-72 md:w-80 md:h-80 bg-white rounded-full border-8 border-sky-200 shadow-inner flex items-center justify-center mb-6 cursor-pointer touch-none"
                            ref={clockRef}
                            onPointerDown={handlePointerDown}
                            onPointerMove={handlePointerMove}
                            onPointerUp={handlePointerUp}
                            onPointerLeave={handlePointerUp}
                            title="æŒ‰ä½æŒ‡é‡å¯ä»¥æ‹–æ›³èª¿æ•´æ™‚é–“å–”ï¼"
                        >
                            <div className="absolute w-full h-full flex items-center justify-center">{renderTicks()}</div>
                            <div className="absolute w-full h-full flex items-center justify-center">{renderClockNumbers()}</div>
                            <div className="absolute w-4 h-4 bg-slate-800 rounded-full z-20 shadow-sm pointer-events-none"></div>

                            {/* æ™‚é‡ */}
                            <div 
                                className={`absolute z-10 rounded-full pointer-events-none transition-all duration-75 ${
                                    isDraggingHour 
                                        ? 'bg-red-400 shadow-[0_0_15px_rgba(239,68,68,0.8)] scale-105' // æ‹–æ›³æ™‚ï¼šè®Šäº®ã€ç™¼å…‰ã€ç¨å¾®è®Šå¤§
                                        : 'bg-red-500 shadow-md' // ä¸€èˆ¬ç‹€æ…‹
                                }`}
                                style={{ width: '12px', height: '70px', bottom: '50%', left: 'calc(50% - 6px)', transformOrigin: 'bottom center', transform: `rotate(${hourDeg}deg)` }}>
                            </div>
                            
                            {/* åˆ†é‡ */}
                            <div 
                                className={`absolute z-10 rounded-full pointer-events-none transition-all duration-75 ${
                                    isDraggingMinute
                                        ? 'bg-blue-400 shadow-[0_0_15px_rgba(59,130,246,0.8)] scale-105' // æ‹–æ›³æ™‚ï¼šè®Šäº®ã€ç™¼å…‰ã€ç¨å¾®è®Šå¤§
                                        : 'bg-blue-500 shadow-md' // ä¸€èˆ¬ç‹€æ…‹
                                }`}
                                style={{ width: '8px', height: '110px', bottom: '50%', left: 'calc(50% - 4px)', transformOrigin: 'bottom center', transform: `rotate(${minuteDeg}deg)` }}
                            />

                            {/* æ‹–æ›³æç¤ºé®ç½© (äº’å‹•å±¤) */}
                            {mode !== 'realtime' && (
                                <div className="absolute w-full h-full rounded-full z-30 opacity-0 active:cursor-grabbing hover:cursor-grab"></div>
                            )}
                        </div>

                        {/* æ“ä½œæŒ‰éˆ• / é¡¯ç¤ºå€ */}
                        <div className="w-full">
                            
                            {/* æ¨¡å¼ 1 & çœŸå¯¦æ™‚é–“ï¼šé¡¯ç¤ºé›»å­é˜ */}
                            {(mode === 'practice' || mode === 'realtime') && (
                                <div className="bg-slate-100 rounded-2xl p-4 w-full flex flex-col items-center justify-center mb-4 relative min-h-[100px]">
                                    {mode === 'practice' && (
                                        <button onClick={() => setShowDigital(!showDigital)}
                                            className="absolute top-2 right-2 text-slate-400 hover:text-slate-600 transition-colors">
                                            {showDigital ? <IconEye size={20} /> : <IconEyeOff size={20} />}
                                        </button>
                                    )}
                                    <div className="text-slate-500 text-sm mb-1 font-bold">ç¾åœ¨æ™‚é–“æ˜¯</div>
                                    {showDigital ? (
                                        <div className="flex items-end gap-2 text-5xl font-mono font-bold tracking-wider">
                                            <span className="text-red-500">{hours}</span>
                                            <span className="text-slate-300 pb-2 text-3xl">:</span>
                                            <span className="text-blue-500">{minutes.toString().padStart(2, '0')}</span>
                                        </div>
                                    ) : (
                                        <div className="flex items-center justify-center h-[48px] text-slate-400 font-bold text-xl">???</div>
                                    )}
                                </div>
                            )}

                            {/* æ¨¡å¼ 2ï¼šæŒ‘æˆ°æ§åˆ¶å€ */}
                            {mode === 'challenge' && (
                                <div className="mb-4 text-center">
                                    {feedback === null ? (
                                        <button 
                                            onClick={checkAnswer}
                                            className="w-full bg-purple-600 hover:bg-purple-700 text-white text-xl py-3 rounded-xl font-bold shadow-lg transition-transform active:scale-95 flex items-center justify-center gap-2"
                                        >
                                            <IconCheck /> æˆ‘æ’¥å¥½äº†ï¼
                                        </button>
                                    ) : (
                                        <div className={`rounded-xl p-4 text-xl font-bold animate-bounce-in ${feedback === 'correct' ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-600'}`}>
                                            {feedback === 'correct' ? (
                                                <div className="flex flex-col items-center gap-2">
                                                    <div className="flex gap-1"><IconStar fill="currentColor" /><IconStar fill="currentColor" /><IconStar fill="currentColor" /></div>
                                                    å¥½æ£’ï¼ç­”å°äº†ï¼
                                                    <button onClick={startChallenge} className="mt-2 text-sm bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700">ä¸‹ä¸€é¡Œ</button>
                                                </div>
                                            ) : (
                                                <div className="flex flex-col items-center gap-2">
                                                    å†è©¦è©¦çœ‹å–”ï¼
                                                    <span className="text-sm font-normal text-slate-600">ç›®å‰çš„æŒ‡é‡æ˜¯ {hours}:{minutes.toString().padStart(2,'0')}</span>
                                                    <button onClick={() => setFeedback(null)} className="mt-2 text-sm bg-white border border-red-200 text-red-600 px-4 py-2 rounded-lg hover:bg-red-50">ç¹¼çºŒå˜—è©¦</button>
                                                </div>
                                            )}
                                        </div>
                                    )}
                                </div>
                            )}

                            {/* é€šç”¨æ§åˆ¶æŒ‰éˆ• (ç·´ç¿’æ¨¡å¼é¡¯ç¤ºï¼ŒæŒ‘æˆ°æ¨¡å¼ä¹Ÿé¡¯ç¤ºè¼”åŠ©å¾®èª¿) */}
                            {mode !== 'realtime' && feedback !== 'correct' && (
                                <div className="mt-4">
                                    {mode === 'practice' && (
                                        <button onClick={setRandomTimePractice}
                                            className="w-full bg-sky-100 hover:bg-sky-200 text-sky-700 py-3 rounded-xl font-bold transition-colors active:scale-95 flex items-center justify-center gap-2 mb-3 shadow-sm">
                                            <IconDice size={22} /> éš¨æ©Ÿå‡ºé¡Œ (ç·´ç¿’æ¨¡å¼)
                                        </button>
                                    )}

                                    <p className="text-center text-slate-400 text-xs mb-2">ğŸ‘‡ ä¹Ÿå¯ä»¥ç”¨æŒ‰éˆ•å¾®èª¿ï¼Œæˆ–ç›´æ¥æ‹–æ›³é˜é¢ ğŸ‘‡</p>
                                    <div className="grid grid-cols-4 gap-2">
                                        <button onClick={() => adjustTime(-60)} className="bg-slate-100 hover:bg-red-100 text-slate-600 hover:text-red-600 py-2 rounded-lg font-bold text-sm">-1æ™‚</button>
                                        <button onClick={() => adjustTime(60)} className="bg-slate-100 hover:bg-red-100 text-slate-600 hover:text-red-600 py-2 rounded-lg font-bold text-sm">+1æ™‚</button>
                                        <button onClick={() => adjustTime(-5)} className="bg-slate-100 hover:bg-blue-100 text-slate-600 hover:text-blue-600 py-2 rounded-lg font-bold text-sm">-5åˆ†</button>
                                        <button onClick={() => adjustTime(5)} className="bg-slate-100 hover:bg-blue-100 text-slate-600 hover:text-blue-600 py-2 rounded-lg font-bold text-sm">+5åˆ†</button>
                                    </div>
                                </div>
                            )}
                        </div>

                    </div>
                    <footer className="mt-8 text-slate-400 text-sm">
                        é©åˆåœ‹å°ä¸€å¹´ç´šæ•¸å­¸å–®å…ƒï¼šèªè­˜æ™‚é˜
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<LearningClock />);
    </script>
</body>
</html>